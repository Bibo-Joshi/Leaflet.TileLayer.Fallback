/*!
 Leaflet.TileLayer.Fallback 1.0.0 (d6563d5)
 (c) 2015-2016 Boris Seang
 License Apache-2.0
 */
!function(i,e){"function"==typeof define&&define.amd?define(["leaflet"],function(t){return i.L.TileLayer.Fallback=e(t)}):"object"==typeof module&&module.exports?module.exports=e(require("leaflet")):i.L.TileLayer.Fallback=e(i.L)}(this,function(i){var e=i.TileLayer,t=e.prototype,r=e.extend({options:{minNativeZoom:0},initialize:function(i,e){t.initialize.call(this,i,e)},createTile:function(i,e){var r=t.createTile.call(this,i,e);return r._originalCoords=i,r._originalSrc=r.src,r},_tileOnError:function(i,e,t){var r,l,o,a=this,n=e._originalCoords,c=e._currentCoords=e._currentCoords||a._wrapCoords(n),s=e._fallbackZoom=(e._fallbackZoom||n.z)-1,f=e._fallbackScale=2*(e._fallbackScale||1),u=a.getTileSize(),p=e.style;return s<a.options.minNativeZoom?void i(t,e):(c.z=s,c.x=Math.floor(c.x/2),c.y=Math.floor(c.y/2),r=a.getTileUrl(c),p.width=u.x*f+"px",p.height=u.y*f+"px",l=(n.y-c.y*f)*u.y,p.marginTop=-l+"px",o=(n.x-c.x*f)*u.x,p.marginLeft=-o+"px",p.clip="rect("+l+"px "+(o+u.x)+"px "+(l+u.y)+"px "+o+"px)",a.fire("tilefallback",{tile:e,url:e._originalSrc,urlMissing:e.src,urlFallback:r}),void(e.src=r))},getTileUrl:function(e){var t=e.z=e.z||this._getZoomForUrl(),r={r:i.Browser.retina?"@2x":"",s:this._getSubdomain(e),x:e.x,y:e.y,z:t};if(this._map&&!this._map.options.crs.infinite){var l=this._globalTileRange.max.y-e.y;this.options.tms&&(r.y=l),r["-y"]=l}return i.Util.template(this._url,i.extend(r,this.options))}});return i.tileLayer.fallback=function(i,e){return new r(i,e)},r});