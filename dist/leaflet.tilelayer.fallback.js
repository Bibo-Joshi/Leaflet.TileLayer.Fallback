/*!
 Leaflet.TileLayer.Fallback 1.0.1 (7fd6db0)
 (c) 2015-2016 Boris Seang
 License Apache-2.0
 */
!function(e,i){"function"==typeof define&&define.amd?define(["leaflet"],function(r){return e.L.TileLayer.Fallback=i(r)}):"object"==typeof module&&module.exports?module.exports=i(require("leaflet")):e.L.TileLayer.Fallback=i(e.L)}(this,function(e){var i=e.TileLayer,r=i.prototype,t=i.extend({options:{minNativeZoom:0},initialize:function(e,i){r.initialize.call(this,e,i)},createTile:function(e,i){var t=r.createTile.call(this,e,i);return t._originalCoords=e,t._originalSrc=t.src,t},_createCurrentCoords:function(e){var i=this._wrapCoords(e);return i.fallback=!0,i},_tileOnError:function(e,i,r){var t,o,l,a=this,n=i._originalCoords,c=i._currentCoords=i._currentCoords||a._createCurrentCoords(n),s=i._fallbackZoom=(i._fallbackZoom||n.z)-1,f=i._fallbackScale=2*(i._fallbackScale||1),u=a.getTileSize(),p=i.style;return s<a.options.minNativeZoom?void e(r,i):(c.z=s,c.x=Math.floor(c.x/2),c.y=Math.floor(c.y/2),t=a.getTileUrl(c),p.width=u.x*f+"px",p.height=u.y*f+"px",o=(n.y-c.y*f)*u.y,p.marginTop=-o+"px",l=(n.x-c.x*f)*u.x,p.marginLeft=-l+"px",p.clip="rect("+o+"px "+(l+u.x)+"px "+(o+u.y)+"px "+l+"px)",a.fire("tilefallback",{tile:i,url:i._originalSrc,urlMissing:i.src,urlFallback:t}),void(i.src=t))},getTileUrl:function(i){var r=i.z=i.fallback?i.z:this._getZoomForUrl(),t={r:e.Browser.retina?"@2x":"",s:this._getSubdomain(i),x:i.x,y:i.y,z:r};if(this._map&&!this._map.options.crs.infinite){var o=this._globalTileRange.max.y-i.y;this.options.tms&&(t.y=o),t["-y"]=o}return e.Util.template(this._url,e.extend(t,this.options))}});return e.tileLayer.fallback=function(e,i){return new t(e,i)},t});